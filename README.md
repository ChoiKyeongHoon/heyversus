# Heyversus

**Heyversus**λ” μ‚¬μ©μκ°€ μ§μ ‘ ν¬ν‘λ¥Ό μƒμ„±ν•κ³  μ°Έμ—¬ν•  μ μλ” λ™μ μΈ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤. Next.jsμ™€ Supabaseλ¥Ό κΈ°λ°μΌλ΅ κµ¬μ¶•λμ–΄ μμΌλ©°, μ‹¤μ‹κ°„ ν¬ν‘ κ²°κ³Όμ™€ μ‚¬μ©μ μΈμ¦, ν¬μΈνΈ μ‹μ¤ν…μ„ μ κ³µν•©λ‹λ‹¤.

## β¨ μ£Όμ” κΈ°λ¥

- **μ‚¬μ©μ μΈμ¦**: Supabase Authλ¥Ό μ΄μ©ν• κ°„νΈν• νμ›κ°€μ…, λ΅κ·ΈμΈ, λ΅κ·Έμ•„μ›ƒ κΈ°λ¥.
- **ν¬ν‘ μƒμ„± λ° κ΄€λ¦¬**:
  - **λ‹¤μ–‘ν• μµμ…**: μ§λ¬Έκ³Ό μ—¬λ¬ μ„ νƒμ§€λ¥Ό ν¬ν•¨ν•λ” ν¬ν‘λ¥Ό μƒμ„±ν•  μ μμµλ‹λ‹¤.
  - **κ³µκ°/λΉ„κ³µκ° μ„¤μ •**: ν¬ν‘λ¥Ό λ¨λ“  μ‚¬λμ΄ μ°Έμ—¬ν•  μ μλ„λ΅ κ³µκ°ν•κ±°λ‚, λ΅κ·ΈμΈν• μ‚¬μ©μλ§ μ°Έμ—¬ν•λ„λ΅ μ ν•ν•  μ μμµλ‹λ‹¤.
  - **λ§λ£ μ‹κ°„ μ„¤μ •**: ν¬ν‘ λ§κ° μ‹κ°„μ„ μ„¤μ •ν•μ—¬ κΈ°κ°„μ΄ μ§€λ‚ ν¬ν‘λ” μλ™μΌλ΅ μΆ…λ£λ©λ‹λ‹¤.
- **μ‹¤μ‹κ°„ ν¬ν‘ μ‹μ¤ν…**:
  - **μµλ… ν¬ν‘**: κ³µκ° ν¬ν‘λ” λ΅κ·ΈμΈν•μ§€ μ•μ€ μ‚¬μ©μλ„ μ°Έμ—¬ν•  μ μμµλ‹λ‹¤.
  - **μ¤‘λ³µ ν¬ν‘ λ°©μ§€**: λ΅κ·ΈμΈ μ‚¬μ©μλ” DBλ¥Ό ν†µν•΄, λΉ„λ΅κ·ΈμΈ μ‚¬μ©μλ” λ΅μ»¬ μ¤ν† λ¦¬μ§€λ¥Ό ν†µν•΄ μ¤‘λ³µ ν¬ν‘λ¥Ό ν¨κ³Όμ μΌλ΅ λ°©μ§€ν•©λ‹λ‹¤.
- **λ€ν‘ ν¬ν‘**: κ΄€λ¦¬μκ°€ μ§€μ •ν• 'μ¤λμ ν¬ν‘'λ¥Ό λ©”μΈ νμ΄μ§€μ— λ…Έμ¶ν•μ—¬ μ‚¬μ©μ μ°Έμ—¬λ¥Ό μ λ„ν•©λ‹λ‹¤.
- **ν¬μΈνΈ λ° λ­ν‚Ή**: ν¬ν‘μ— μ°Έμ—¬ν•  λ•λ§λ‹¤ ν¬μΈνΈλ¥Ό νλ“ν•κ³ , λ‹¤λ¥Έ μ‚¬μ©μλ“¤κ³Όμ μμ„λ¥Ό `SCORE` νμ΄μ§€μ—μ„ ν™•μΈν•  μ μμµλ‹λ‹¤.
- **μ‚¬μ©μ κ²½ν—(UX) μµμ ν™”**:
  - **μ‹ μ†ν• ν”Όλ“λ°±**: `sonner` λΌμ΄λΈλ¬λ¦¬λ¥Ό ν™μ©ν•μ—¬ μ§κ΄€μ μΈ Toast μ•λ¦Όμ„ μ κ³µν•©λ‹λ‹¤.
  - **μλ™ λ¦¬λ””λ ‰μ…**: λ΅κ·ΈμΈ ν›„ μ΄μ „μ— λ³΄λ νμ΄μ§€λ΅ μλ™ μ΄λ™ν•μ—¬ μ‚¬μ© νλ¦„μ΄ λκΈ°μ§€ μ•λ„λ΅ ν•©λ‹λ‹¤.
  - **λ°μ΄ν„° μλ™ κ°±μ‹ **: νμ΄μ§€μ— λ‹¤μ‹ λ°©λ¬Έν–μ„ λ• μµμ‹  ν¬ν‘ λ°μ΄ν„°λ¥Ό μλ™μΌλ΅ λ¶λ¬μ™€ λ³΄μ—¬μ¤λ‹λ‹¤.

## π› οΈ κΈ°μ  μ¤νƒ

- **ν”„λ μ„μ›ν¬**: Next.js (App Router)
- **μ–Έμ–΄**: TypeScript
- **μ¤νƒ€μΌλ§**: Tailwind CSS
- **λ°±μ—”λ“ (BaaS)**: Supabase (Auth, PostgreSQL, Storage, Edge Functions)
- **UI μ»΄ν¬λ„νΈ**: shadcn/ui
- **μƒνƒ κ΄€λ¦¬**: React Context (Session Provider)
- **ν°νΈ μµμ ν™”**: `next/font`
- **μ•λ¦Ό**: Sonner (Toast notifications)
- **λ°°ν¬**: Vercel

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
/
β”β”€β”€ public/              # μ •μ  μ—μ…‹ (μ΄λ―Έμ§€, ν°νΈ λ“±)
β”β”€β”€ src/
β”‚   β”β”€β”€ app/             # Next.js App Router νμ΄μ§€ λ° λ μ΄μ•„μ›ƒ
β”‚   β”‚   β”β”€β”€ page.tsx     # λ©”μΈ λλ”© νμ΄μ§€ (λ€ν‘ ν¬ν‘)
β”‚   β”‚   β”β”€β”€ signin/      # λ΅κ·ΈμΈ νμ΄μ§€
β”‚   β”‚   β”β”€β”€ signup/      # νμ›κ°€μ… νμ΄μ§€
β”‚   β”‚   β”β”€β”€ create-poll/ # ν¬ν‘ μƒμ„± νμ΄μ§€
β”‚   β”‚   β”β”€β”€ polls/       # μ „μ²΄ ν¬ν‘ λ©λ΅ νμ΄μ§€
β”‚   β”‚   β”β”€β”€ poll/[id]/   # ν¬ν‘ μƒμ„Έ λ° κ²°κ³Ό νμ΄μ§€
β”‚   β”‚   β””β”€β”€ score/       # μ‚¬μ©μ λ­ν‚Ή(μ¤μ½”μ–΄λ³΄λ“) νμ΄μ§€
β”‚   β”β”€β”€ components/      # μ¬μ‚¬μ© κ°€λ¥ν• UI μ»΄ν¬λ„νΈ
β”‚   β”β”€β”€ lib/             # κ³µν†µ μ ν‹Έλ¦¬ν‹° λ° Supabase ν΄λΌμ΄μ–ΈνΈ
β”‚   β””β”€β”€ middleware.ts    # Supabase μ„Έμ… κ΄€λ¦¬ λ―Έλ“¤μ›¨μ–΄
β”β”€β”€ QUERY.md             # λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ (SQL)
β””β”€β”€ README.md            # ν”„λ΅μ νΈ λ¬Έμ„
```

## π“ λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§

`QUERY.md` νμΌμ€ μ „μ²΄ λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§λ¥Ό μ •μν•©λ‹λ‹¤. μ£Όμ” ν…μ΄λΈ” κ°„μ κ΄€κ³„λ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

```mermaid
erDiagram
    users ||--|{ profiles : "has one"
    users ||--o{ polls : "creates"
    users ||--o{ user_votes : "casts"

    polls ||--|{ poll_options : "contains"
    polls ||--o{ user_votes : "is voted on"

    poll_options ||--o{ user_votes : "is chosen in"

    users {
        UUID id PK
        string email
        timestamptz created_at
    }

    profiles {
        UUID id PK
        string username
        int points
        timestamptz updated_at
    }

    polls {
        UUID id PK
        text question
        UUID created_by
        boolean is_public
        boolean is_featured
        timestamptz created_at
        timestamptz expires_at
        varchar status
    }

    poll_options {
        UUID id PK
        UUID poll_id
        text text
        int votes
        text image_url
    }

    user_votes {
        UUID id PK
        UUID user_id
        UUID poll_id
        UUID option_id
        timestamptz created_at
    }
```

## π“ μ—…λ°μ΄νΈ κΈ°λ΅

### v0.1.3

- **μ„λΉ„μ¤ κ³„μΈµ λ„μ…**: `src/lib/services/polls.ts`μ— `getPolls`, `getPollById`, `getFeaturedPolls`, `createPoll`, `voteOnPoll`, `getLeaderboard` ν•¨μλ¥Ό μ¶”κ°€ν•μ—¬ λΉ„μ¦λ‹μ¤ λ΅μ§μ„ μ¬μ‚¬μ© κ°€λ¥ν•κ² λ¶„λ¦¬.
- **API Route ν•Έλ“¤λ¬ κµ¬ν„**: `src/app/api/polls/route.ts`, `src/app/api/polls/[id]/route.ts`, `src/app/api/polls/[id]/vote/route.ts`λ΅ RESTful API μ—”λ“ν¬μΈνΈ κµ¬μ„±. μ„λ²„ μ „μ© λ΅μ§μ„ API κ³„μΈµμΌλ΅ μ΄μ „ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ™€μ λ…ν™•ν• λ¶„λ¦¬ ν™•λ³΄.
- **Next.js μΊμ‹± μ „λµ μ μ©**: μ„λΉ„μ¤ ν•¨μμ— `unstable_cache`μ™€ `tags`λ¥Ό μ„ μ–Έν•΄ μΌκ΄€λ λ°μ΄ν„° κ°±μ‹  λ΅μ§ μ μ©. `revalidatePath`λ΅ ν¬ν‘ ν›„ μλ™ λ°μ΄ν„° κ°±μ‹ .
- **λ°μ΄ν„° μ‹λ”© μ¤ν¬λ¦½νΈ μ¶”κ°€**: `scripts/seed.ts`μ™€ `npm run db:seed` λ…λ ΉμΌλ΅ λ΅μ»¬ κ°λ° ν™κ²½μ—μ„ μƒν” ν¬ν‘ λ°μ΄ν„°λ¥Ό κ°„νΈν•κ² μƒμ„± κ°€λ¥.

### v0.1.2

- **νƒ€μ… μ‹μ¤ν… κ°μ„ **: `src/lib/types.ts`μ Poll μΈν„°νμ΄μ¤λ¥Ό DB μ¤ν‚¤λ§μ™€ μ™„μ „ν λ™κΈ°ν™”. `created_by`, `is_public`, `is_featured`, `featured_image_url` ν•„λ“ μ¶”κ°€, `expires_at`μ„ `string | null`λ΅ μμ •ν•μ—¬ μκµ¬ ν¬ν‘ μ§€μ›.
- **Next.js 15 νΈν™μ„±**: Image μ»΄ν¬λ„νΈμ deprecated props (`layout`, `objectFit`) μ κ±°, μµμ‹  API (`fill`, `sizes`, `style`) μ μ©μΌλ΅ λΉλ“ κ²½κ³  μ κ±° λ° μ„±λ¥ μµμ ν™”.
- **λ°μ΄ν„°λ² μ΄μ¤ μ„±λ¥ μµμ ν™”**: `QUERY.md`μ— 8κ°μ μΈλ±μ¤ μ¶”κ°€ - `poll_options(poll_id)`, `user_votes(poll_id, user_id)`, `polls(is_featured, is_public, created_at)`, `profiles(points)` λ“±μΌλ΅ μ΅°ν μ„±λ¥ 10~100λ°° κ°μ„  κ°€λ¥.
- **μ„λ²„ μΈ΅ λ°μ΄ν„° κ²€μ¦ κ°•ν™”**: `create_new_poll` ν•¨μμ— μ§λ¬Έ/μµμ… ν•„μ κ²€μ¦, κ°μ μ ν•(2~6κ°), λ§λ£ μ‹κ°„ κ²€μ¦ λ΅μ§ μ¶”κ°€λ΅ λ°μ΄ν„° λ¬΄κ²°μ„± ν™•λ³΄.
- **λ λ”λ§ μ„±λ¥ μµμ ν™”**: `useSupabase` μ»¤μ¤ν…€ ν›… (`src/hooks/useSupabase.ts`) μƒμ„±μΌλ΅ Supabase ν΄λΌμ΄μ–ΈνΈ μΈμ¤ν„΄μ¤λ¥Ό `useMemo`λ΅ μµμ ν™”, λ¶ν•„μ”ν• μ¬μƒμ„± λ°©μ§€.
- **μ½”λ“ μ •ν•©μ„± ν™•μΈ**: `increment_vote` νΈμ¶ νλΌλ―Έν„° ν†µμΌμ„± κ²€μ¦, `poll.question` ν•„λ“ μΌκ΄€μ„± ν™•μΈ μ™„λ£.

### v0.1.1

- P0 μ΄μ ν•΄κ²°: `src/lib/utils.ts`μ— `isPollExpired`, `formatExpiryDate` μ ν‹Έμ„ μ¶”κ°€ν•μ—¬ λ§λ£ μ‹κ°„μ΄ μ—†λ” ν¬ν‘κ°€ μλ» λ§κ° μ²λ¦¬λμ§€ μ•λ„λ΅ μμ •ν•¨.
- ν¬ν‘ λ©λ΅ ν™”λ©΄ (`src/app/polls/PollsClient.tsx`)μ—μ„ μƒ μ ν‹Έμ„ μ‚¬μ©ν•΄ μκµ¬ ν¬ν‘ μƒνƒμ™€ λ§κ° ν‘μ‹λ¥Ό "κΈ°ν• μ—†μ"μΌλ΅ λ…Έμ¶ν•λ„λ΅ μ΅°μ •ν•¨.
- ν¬ν‘ μƒμ„Έ ν™”λ©΄ (`src/app/poll/[id]/PollClient.tsx`)μ—μ„λ„ λ™μΌν• λ΅μ§μ„ μ μ©ν•΄ μκµ¬ ν¬ν‘λ¥Ό μ •μƒμ μΌλ΅ μ°Έμ—¬ κ°€λ¥ν• μƒνƒλ΅ μ μ§€ν•¨.
